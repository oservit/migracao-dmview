-- Ordem: 045 | Tabela: MATRIX | Depth: 3
INSERT INTO CLARO.MATRIX (
MATRIX_ID,
PROXY_CODE,
MUX_NO,
MUX_LOCAL_ID,
SLOT_MATRIX,
PORT_MATRIX,
TS0_TYPE,
TS0_TS,
TS1_TYPE,
TS1_TS,
TS2_TYPE,
TS2_TS,
TS3_TYPE,
TS3_TS,
TS4_TYPE,
TS4_TS,
TS5_TYPE,
TS5_TS,
TS6_TYPE,
TS6_TS,
TS7_TYPE,
TS7_TS,
TS8_TYPE,
TS8_TS,
TS9_TYPE,
TS9_TS,
TS10_TYPE,
TS10_TS,
TS11_TYPE,
TS11_TS,
TS12_TYPE,
TS12_TS,
TS13_TYPE,
TS13_TS,
TS14_TYPE,
TS14_TS,
TS15_TYPE,
TS15_TS,
TS16_TYPE,
TS16_TS,
TS17_TYPE,
TS17_TS,
TS18_TYPE,
TS18_TS,
TS19_TYPE,
TS19_TS,
TS20_TYPE,
TS20_TS,
TS21_TYPE,
TS21_TS,
TS22_TYPE,
TS22_TS,
TS23_TYPE,
TS23_TS,
TS24_TYPE,
TS24_TS,
TS25_TYPE,
TS25_TS,
TS26_TYPE,
TS26_TS,
TS27_TYPE,
TS27_TS,
TS28_TYPE,
TS28_TS,
TS29_TYPE,
TS29_TS,
TS30_TYPE,
TS30_TS,
TS31_TYPE,
TS31_TS,
CONTROL,
TS0_PORT,
TS1_PORT,
TS2_PORT,
TS3_PORT,
TS4_PORT,
TS5_PORT,
TS6_PORT,
TS7_PORT,
TS8_PORT,
TS9_PORT,
TS10_PORT,
TS11_PORT,
TS12_PORT,
TS13_PORT,
TS14_PORT,
TS15_PORT,
TS16_PORT,
TS17_PORT,
TS18_PORT,
TS19_PORT,
TS20_PORT,
TS21_PORT,
TS22_PORT,
TS23_PORT,
TS24_PORT,
TS25_PORT,
TS26_PORT,
TS27_PORT,
TS28_PORT,
TS29_PORT,
TS30_PORT,
TS31_PORT,
ERP_CODE
)
SELECT 
src.MATRIX_ID,
j164.CL___PROXY_CODE__CL AS PROXY_CODE,
j164.CL___MUX_NO__CL AS MUX_NO,
j164.CL___MUX_LOCAL_ID__CL AS MUX_LOCAL_ID,
src.SLOT_MATRIX,
src.PORT_MATRIX,
src.TS0_TYPE,
src.TS0_TS,
src.TS1_TYPE,
src.TS1_TS,
src.TS2_TYPE,
src.TS2_TS,
src.TS3_TYPE,
src.TS3_TS,
src.TS4_TYPE,
src.TS4_TS,
src.TS5_TYPE,
src.TS5_TS,
src.TS6_TYPE,
src.TS6_TS,
src.TS7_TYPE,
src.TS7_TS,
src.TS8_TYPE,
src.TS8_TS,
src.TS9_TYPE,
src.TS9_TS,
src.TS10_TYPE,
src.TS10_TS,
src.TS11_TYPE,
src.TS11_TS,
src.TS12_TYPE,
src.TS12_TS,
src.TS13_TYPE,
src.TS13_TS,
src.TS14_TYPE,
src.TS14_TS,
src.TS15_TYPE,
src.TS15_TS,
src.TS16_TYPE,
src.TS16_TS,
src.TS17_TYPE,
src.TS17_TS,
src.TS18_TYPE,
src.TS18_TS,
src.TS19_TYPE,
src.TS19_TS,
src.TS20_TYPE,
src.TS20_TS,
src.TS21_TYPE,
src.TS21_TS,
src.TS22_TYPE,
src.TS22_TS,
src.TS23_TYPE,
src.TS23_TS,
src.TS24_TYPE,
src.TS24_TS,
src.TS25_TYPE,
src.TS25_TS,
src.TS26_TYPE,
src.TS26_TS,
src.TS27_TYPE,
src.TS27_TS,
src.TS28_TYPE,
src.TS28_TS,
src.TS29_TYPE,
src.TS29_TS,
src.TS30_TYPE,
src.TS30_TS,
src.TS31_TYPE,
src.TS31_TS,
src.CONTROL,
src.TS0_PORT,
src.TS1_PORT,
src.TS2_PORT,
src.TS3_PORT,
src.TS4_PORT,
src.TS5_PORT,
src.TS6_PORT,
src.TS7_PORT,
src.TS8_PORT,
src.TS9_PORT,
src.TS10_PORT,
src.TS11_PORT,
src.TS12_PORT,
src.TS13_PORT,
src.TS14_PORT,
src.TS15_PORT,
src.TS16_PORT,
src.TS17_PORT,
src.TS18_PORT,
src.TS19_PORT,
src.TS20_PORT,
src.TS21_PORT,
src.TS22_PORT,
src.TS23_PORT,
src.TS24_PORT,
src.TS25_PORT,
src.TS26_PORT,
src.TS27_PORT,
src.TS28_PORT,
src.TS29_PORT,
src.TS30_PORT,
src.TS31_PORT,
TRIM(CAST(src.MATRIX_ID AS VARCHAR2(64))) AS ERP_CODE
FROM OI.MATRIX src
LEFT JOIN CLARO.TB___MUXS__TB j164 ON j164.ERP_CODE = LOWER(RAWTOHEX(STANDARD_HASH(TRIM(CAST(src.PROXY_CODE AS VARCHAR2(100))) || '|' || TRIM(CAST(src.MUX_NO AS VARCHAR2(100))) || '|' || TRIM(CAST(src.MUX_LOCAL_ID AS VARCHAR2(100))), 'MD5')))
WHERE NOT EXISTS (SELECT 1 FROM CLARO.MATRIX dest WHERE dest.ERP_CODE = TRIM(CAST(src.MATRIX_ID AS VARCHAR2(64))));
